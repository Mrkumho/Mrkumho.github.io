## 1. Docker 네트워크 종류

- **none**:  
  - 네트워크에 연결되지 않은 상태  
  - 외부와 통신 불가, 다른 컨테이너와도 통신 불가  
  - 완전히 격리된 환경이 필요할 때 사용
    
- **host**:  
  - 컨테이너가 호스트의 네트워크를 그대로 사용  
  - 네트워크 격리 없음 (컨테이너와 호스트가 같은 IP, 같은 포트 사용)  
  - 성능은 좋지만 보안/격리 측면에서 주의 필요

- **bridge** (기본값):  
  - Docker가 기본으로 생성하는 가상 네트워크 (docker0)  
  - 컨테이너마다 내부 IP가 할당되고, 같은 브리지 내 컨테이너끼리 통신 가능  
  - 외부에서 접근하려면 포트 매핑 필요

---

## 2. Bridge 네트워크 동작 방식

- Docker 설치 시 호스트에 `docker0`라는 브리지 네트워크가 자동 생성됨
- 컨테이너를 생성하면,  
  - 컨테이너마다 독립된 네트워크 네임스페이스 생성
  - veth(가상 이더넷) 쌍으로 호스트와 컨테이너 네임스페이스 연결
  - 한쪽은 컨테이너 네임스페이스, 한쪽은 docker0 브리지에 연결됨
- 컨테이너는 브리지 네트워크의 내부 IP(예: 172.17.0.x)를 할당받음
- 같은 브리지 네트워크에 연결된 컨테이너끼리는 자유롭게 통신 가능

---

## 3. 네임스페이스와 veth 연결

- 컨테이너마다 독립된 네트워크 네임스페이스가 생성됨
- veth 쌍을 통해 호스트와 컨테이너 네임스페이스가 연결됨
- 호스트에서 `ip link` 명령으로 veth 인터페이스 확인 가능
- 컨테이너 내부에서는 `ip addr`로 자신의 IP 확인 가능

---

## 4. 포트 매핑 (Port Mapping, Publishing)

- 브리지 네트워크에 있는 컨테이너는 외부에서 직접 접근 불가
- 외부에서 접근하려면 **포트 매핑** 필요
  예시:  
  - 호스트의 8080 포트를 컨테이너의 80 포트에 연결  
  - `docker run -p 8080:80 nginx`
- 이 설정을 하면,  
  - 외부에서 호스트IP:8080으로 접속 → 컨테이너의 80번 포트로 트래픽 전달

---

## 5. Docker의 포트 포워딩 원리

- Docker는 iptables의 NAT 기능을 이용해 포트 포워딩을 구현
- 호스트로 들어온 트래픽을 컨테이너의 IP와 포트로 전달하는 규칙을 자동으로 추가
- `iptables -t nat -L` 명령으로 실제 룰 확인 가능

---

## 6. 실습 명령어 예시

- 브리지 네트워크 목록 확인:
```bash
docker network ls
```
- 컨테이너 실행 시 네트워크 지정:
```bash
docker run --network=bridge -d nginx
docker run --network=host -d nginx
docker run --network=none -d nginx
```


- 포트 매핑:
```bash
docker run -d -p 8080:80 nginx
```
text
- 컨테이너 내부 IP 확인:
```bash
docker exec -it <container_name> ip addr
```

---

## 7. 요약

- Docker는 다양한 네트워크 모드를 제공하며, 기본적으로 bridge(가상 네트워크 스위치)를 사용
- 컨테이너는 독립적인 네임스페이스와 veth 쌍을 통해 호스트와 연결됨
- 외부 접근은 포트 매핑을 통해 가능하며, Docker는 iptables를 활용해 트래픽을 포워딩함
- 네트워크 모드와 포트 매핑 방식을 이해하면 Docker의 네트워크 동작 구조를 쉽게 파악할 수 있음
